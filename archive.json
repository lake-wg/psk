{
  "magic": "E!vIA5L86J2I",
  "timestamp": "2025-05-13T01:06:04.313983+00:00",
  "repo": "lake-wg/psk",
  "labels": [
    {
      "name": "bug",
      "description": "Something isn't working",
      "color": "d73a4a"
    },
    {
      "name": "documentation",
      "description": "Improvements or additions to documentation",
      "color": "0075ca"
    },
    {
      "name": "duplicate",
      "description": "This issue or pull request already exists",
      "color": "cfd3d7"
    },
    {
      "name": "enhancement",
      "description": "New feature or request",
      "color": "a2eeef"
    },
    {
      "name": "good first issue",
      "description": "Good for newcomers",
      "color": "7057ff"
    },
    {
      "name": "help wanted",
      "description": "Extra attention is needed",
      "color": "008672"
    },
    {
      "name": "invalid",
      "description": "This doesn't seem right",
      "color": "e4e669"
    },
    {
      "name": "question",
      "description": "Further information is requested",
      "color": "d876e3"
    },
    {
      "name": "wontfix",
      "description": "This will not be worked on",
      "color": "ffffff"
    },
    {
      "name": "close?",
      "description": "",
      "color": "c5def5"
    }
  ],
  "issues": [
    {
      "number": 1,
      "id": "I_kwDONwrUhc6pXtPd",
      "title": "Not compiling",
      "url": "https://github.com/lake-wg/psk/issues/1",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "ElsaLopez133"
      ],
      "labels": [],
      "body": "The draft is not automatically compiling on GitHub as it should. Seems like it has never compiled after moving to lake-wg\n\nThe draft (venue:) and readme markdown refered to the old repository. I fixed this, but some of the links in Readme.md does not work as it has never compiled on the new lake-wg repo.\n\n(I fixed a few other things in the header like silencing a SVG warning and fixing my name.)\n\n",
      "createdAt": "2025-02-10T07:26:21Z",
      "updatedAt": "2025-02-11T17:33:41Z",
      "closedAt": "2025-02-11T17:33:40Z",
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Easist might be to set up a new repo using the template\nhttps://github.com/martinthomson/internet-draft-template\n\nThere are no issues to keep track of.",
          "createdAt": "2025-02-10T16:21:30Z",
          "updatedAt": "2025-02-10T16:21:30Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Everything works now",
          "createdAt": "2025-02-11T17:33:40Z",
          "updatedAt": "2025-02-11T17:33:40Z"
        }
      ]
    },
    {
      "number": 2,
      "id": "I_kwDONwrUhc6pdKiM",
      "title": "Acknowledgments",
      "url": "https://github.com/lake-wg/psk/issues/2",
      "state": "OPEN",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "gselander",
        "rml1977"
      ],
      "labels": [],
      "body": "Just add\n\nThe authors want to thank ....\n\nAnd list everyone that has provided relevant comments of any kind.\n",
      "createdAt": "2025-02-10T16:34:31Z",
      "updatedAt": "2025-02-26T07:15:00Z",
      "closedAt": null,
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I made a first version with a few version, but many people are likely missing.\n\n```\nAcknowledgments\n\n  The authors want to thank Christian Ams\u00fcss, Scott Fluhrer, and Marco\n   Tiloca for reviewing and commenting on intermediate versions of the\n   draft.\n```",
          "createdAt": "2025-02-10T16:36:11Z",
          "updatedAt": "2025-02-11T17:37:01Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I looked at the lake mailing list and added Charlie Jacomme. I think that is all",
          "createdAt": "2025-02-18T09:53:12Z",
          "updatedAt": "2025-02-18T09:53:12Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Should add EU projects etc.",
          "createdAt": "2025-02-18T09:53:49Z",
          "updatedAt": "2025-02-18T09:53:49Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "In my case, this work is partly supported by ONOFRE4  PID2023-148104OB-C43 funded by MICIU/AEI/10.13039/501100011033  and FEDER/UE EU HE CASTOR under Grant Agreement No 101167904, EU CERTIFY under Grant Agreement No 101069471",
          "createdAt": "2025-02-18T11:57:29Z",
          "updatedAt": "2025-02-18T11:57:29Z"
        },
        {
          "author": "gselander",
          "authorAssociation": "CONTRIBUTOR",
          "body": "All: Please add your acknowledgements directly to the section. ",
          "createdAt": "2025-02-18T13:56:25Z",
          "updatedAt": "2025-02-18T13:56:25Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Added",
          "createdAt": "2025-02-26T07:14:59Z",
          "updatedAt": "2025-02-26T07:14:59Z"
        }
      ]
    },
    {
      "number": 3,
      "id": "I_kwDONwrUhc6pdNF7",
      "title": "IANA Considerations",
      "url": "https://github.com/lake-wg/psk/issues/3",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "ElsaLopez133"
      ],
      "labels": [],
      "body": "Needs to add the PSK method to the \"EDHOC Method Type Registry\"\n\nNeeds to add a label to to the \"EDHOC Exporter Label Registry\" to be used for resumption",
      "createdAt": "2025-02-10T16:38:35Z",
      "updatedAt": "2025-02-26T17:24:14Z",
      "closedAt": "2025-02-26T17:24:14Z",
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Create new registry for info_labels. This was missed in RFC9528",
          "createdAt": "2025-02-11T09:20:27Z",
          "updatedAt": "2025-02-11T09:20:27Z"
        }
      ]
    },
    {
      "number": 4,
      "id": "I_kwDONwrUhc6pdUhW",
      "title": "message_3 reveals the length of the PSK identifier and does not allow padding",
      "url": "https://github.com/lake-wg/psk/issues/4",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "emanjon"
      ],
      "labels": [
        "close?"
      ],
      "body": "```\nEnc( ID_CRED_PSK ), AEAD( EAD_3 )\n\nmessage_3 = (\n  CIPHERTEXT_3A: bstr,\n  CIPHERTEXT_3B: bstr,\n)\n\n```\n\nmessage_3 reveals the length of the PSK identifier and does not allow padding. Padding is only supported in EAD_3",
      "createdAt": "2025-02-10T16:49:35Z",
      "updatedAt": "2025-05-01T19:39:16Z",
      "closedAt": "2025-05-01T19:39:16Z",
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Fixed in main",
          "createdAt": "2025-02-17T18:16:25Z",
          "updatedAt": "2025-02-17T18:16:25Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Just a comment: my understanding is that now Appendix G.  Long PLAINTEXT_2 is applicable to Message_3 in EDHOC-PSK when enabling the encryption of ID_CRED_PSK and AEAD (EAD_3) with KEYSTREAM_3.",
          "createdAt": "2025-02-25T15:54:54Z",
          "updatedAt": "2025-02-25T15:54:54Z"
        }
      ]
    },
    {
      "number": 5,
      "id": "I_kwDONwrUhc6pe7gh",
      "title": "Appendix with Change log",
      "url": "https://github.com/lake-wg/psk/issues/5",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "emanjon"
      ],
      "labels": [],
      "body": "",
      "createdAt": "2025-02-10T19:46:03Z",
      "updatedAt": "2025-02-18T07:03:11Z",
      "closedAt": "2025-02-18T07:03:11Z",
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Done in main",
          "createdAt": "2025-02-18T07:01:01Z",
          "updatedAt": "2025-02-18T07:01:01Z"
        }
      ]
    },
    {
      "number": 6,
      "id": "I_kwDONwrUhc6pe7qF",
      "title": "Apendix with CDDL definitions",
      "url": "https://github.com/lake-wg/psk/issues/6",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2025-02-10T19:46:23Z",
      "updatedAt": "2025-02-11T08:53:36Z",
      "closedAt": "2025-02-11T08:53:34Z",
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Fixed in main",
          "createdAt": "2025-02-11T08:53:34Z",
          "updatedAt": "2025-02-11T08:53:34Z"
        }
      ]
    },
    {
      "number": 7,
      "id": "I_kwDONwrUhc6pfEzW",
      "title": "Resumption",
      "url": "https://github.com/lake-wg/psk/issues/7",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "rml1977",
        "ElsaLopez133"
      ],
      "labels": [],
      "body": "Specify how this is used for resumption",
      "createdAt": "2025-02-10T20:01:29Z",
      "updatedAt": "2025-05-01T19:39:03Z",
      "closedAt": "2025-05-01T19:39:03Z",
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Comment from Charlie Jacomme:\n\n```\n* should we make sure that a PSK derived from some EDHOC exchange with \nsome ciphersuite SUITE can only be used for resumption with the \ncorresponding SUITE or higher?\n```\nhttps://mailarchive.ietf.org/arch/msg/lake/IdMFc1kDqdGhg6GCvlo22dZmJp0/\n\nI agree I think we should make sure that a PSK derived from some EDHOC exchange with \nsome ciphersuite SUITE can only be used for resumption with the  corresponding SUITE.",
          "createdAt": "2025-02-18T09:49:32Z",
          "updatedAt": "2025-02-18T09:49:32Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "As we have identity protection we can allow reuse of the resumption key.",
          "createdAt": "2025-02-18T09:51:21Z",
          "updatedAt": "2025-02-18T09:51:21Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "In the same way that TLS 1.3 does, we should explicitly distinguish between \"external PSK\" (the out-of-band PSK) and \"resumption PSK\"\n\nThen adding the derivation of ID_CRED_PSK and rPSK . I think they should be derived from PRK_out.",
          "createdAt": "2025-02-18T11:55:28Z",
          "updatedAt": "2025-02-18T11:55:28Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "> In the same way that TLS 1.3 does, we should explicitly distinguish between \"external PSK\" (the out-of-band PSK) and \"resumption PSK\"\n\nThat is good terminology but I don't see any technical differences.\n\n> Then adding the derivation of ID_CRED_PSK and rPSK . I think they should be derived from PRK_out.\n\nYes, just add add a couple of exporter labels.\n\n",
          "createdAt": "2025-02-18T12:15:51Z",
          "updatedAt": "2025-02-18T12:15:51Z"
        },
        {
          "author": "gselander",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Missing:\n* Exporter label to derive PSK\n* Exporter label to derive key identifier\n* Distinction between I and R (see #14)\n* Being able to switch roles (or why not)",
          "createdAt": "2025-02-18T13:09:57Z",
          "updatedAt": "2025-02-18T13:11:01Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Regarding this part, at the beginning of security section we have a distinction between *Initial Handshake* and *Session Resumption*. In the session resumption part, I do not think we need to reuse the same ID_CRED_PSK and CRED_PSK for resumption PSK. Each time EDHOC-PSK is run a new PRK_Exporter will be generated, which means a new  (resumption) ID_CRED_PSK and CRED_PSK will be generated.",
          "createdAt": "2025-02-24T13:47:34Z",
          "updatedAt": "2025-02-24T13:47:34Z"
        },
        {
          "author": "ElsaLopez133",
          "authorAssociation": "CONTRIBUTOR",
          "body": "And how would you derive the ID_CRED_PSK and the CRED_PSK from a PRK_exporter?\n",
          "createdAt": "2025-02-24T14:08:33Z",
          "updatedAt": "2025-02-24T14:08:33Z"
        },
        {
          "author": "ElsaLopez133",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Could it be by using EDHOC_Expand? So say CRED_PSK = EDHOC_Expand(PRK_Exporter, label, context, length)?\nAnd as for ID_CRED_PSK it could be derived from CRED_PSK?",
          "createdAt": "2025-02-24T14:12:36Z",
          "updatedAt": "2025-02-24T14:12:36Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Yes, that is why G\u00f6ran annotated that we need an:\n\n\"Exporter label to derive PSK\nExporter label to derive key identifier\"",
          "createdAt": "2025-02-24T14:15:08Z",
          "updatedAt": "2025-02-24T14:15:08Z"
        },
        {
          "author": "ElsaLopez133",
          "authorAssociation": "CONTRIBUTOR",
          "body": "And what would the context of the Expand function be in this case? \nAnd for the labels right now EDHOC only has 0, 1, so could it be 2 and 3 for CRED_PSK and ID_CRED_PSK?\n",
          "createdAt": "2025-02-24T14:18:51Z",
          "updatedAt": "2025-02-24T14:31:25Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "According to 10.1.  EDHOC Exporter Label Registry (in RFC 9528) 2 an 3 would do (0 and 1 are assigned to OSCORE Master Secret and OSCORE Master Salt, respectively). About the context , we can the same as for deriving OSCORE Master Secret and Master Salt\n\nrPSK = EDHOC_Exporter( 2, h'', resumption_psk_length )\nrID_CRED_PSK   = EDHOC_Exporter( 3, h'', id_cred_psk_length )\n\nI guess with \"enough\" id_cred_psk_length we can avoid any collision. I added \"r\" to distinguish from the PSK and ID_CRED_PSK but I do not know if this will be necessary",
          "createdAt": "2025-02-24T14:35:14Z",
          "updatedAt": "2025-02-24T14:35:14Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I was wondering whether having a rID_CRED_PSK derived in this way might a be a problem. Since the responder does not choose the value, might be collision. To avoid that, as I mentioned, the rID_CRED_PSK should have \"enough\" length to reduce the probability of a collision but the drawback is that we may want to have a really short rID_CRED_PSK",
          "createdAt": "2025-02-24T17:19:31Z",
          "updatedAt": "2025-02-24T17:19:31Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Another option for this  would be that the Responder chooses the new ID_CRED_PSK and include this in message_4. If the new ID_CRED_PSK is sent in message_4 , this also can signal that resumption PSK must be generated. ",
          "createdAt": "2025-02-26T07:17:54Z",
          "updatedAt": "2025-02-26T07:17:54Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I have added text for external PSK and resumption PSK",
          "createdAt": "2025-02-26T07:18:13Z",
          "updatedAt": "2025-02-26T07:18:13Z"
        }
      ]
    },
    {
      "number": 8,
      "id": "I_kwDONwrUhc6pfJkS",
      "title": "Exact values of info_labels",
      "url": "https://github.com/lake-wg/psk/issues/8",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "```\nKEYSTREAM_3 = EDHOC_KDF( PRK_3e2m, TBD1, TH_3, ID_CRED_PSK length )\nK_3         = EDHOC_KDF( PRK_4e3m, TBD2, TH_3, key_length )\nIV_3        = EDHOC_KDF( PRK_4e3m, TBD3, TH_3, iv_length )\n```\n\nTBD1 is a new value.\n\nIs the info_labels for K_3 and IV_3 the same as in RFC 9528?\n\n@gselander why do we not have a IANA registry for info_labels?",
      "createdAt": "2025-02-10T20:11:23Z",
      "updatedAt": "2025-02-18T13:13:19Z",
      "closedAt": "2025-02-18T13:13:19Z",
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "TBD1, TBD2, and TBD3 are all new values. Need to define a new registry for this.",
          "createdAt": "2025-02-11T09:56:45Z",
          "updatedAt": "2025-02-11T09:56:45Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "The values should have TBD1, TBD2, and TBD3. Need a IANA registry. This is handled in #3 ",
          "createdAt": "2025-02-11T17:35:09Z",
          "updatedAt": "2025-02-11T17:35:09Z"
        },
        {
          "author": "gselander",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Reopening this. Since we are creating the registry we can assign these values 11, 12, 13 ourselves. ",
          "createdAt": "2025-02-18T12:49:31Z",
          "updatedAt": "2025-02-18T12:49:31Z"
        }
      ]
    },
    {
      "number": 9,
      "id": "I_kwDONwrUhc6pkKyb",
      "title": "New names for PLAINTEXT_2 and PLAINTEXT_3 to avoid colliding CDDL",
      "url": "https://github.com/lake-wg/psk/issues/9",
      "state": "CLOSED",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2025-02-11T09:35:20Z",
      "updatedAt": "2025-02-11T09:55:54Z",
      "closedAt": "2025-02-11T09:55:53Z",
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Changed to PLAINTEXT_2B and PLAINTEXT_3B in main.\n\n(Not sure these are the optimal names, but that can be changed later)",
          "createdAt": "2025-02-11T09:55:53Z",
          "updatedAt": "2025-02-11T09:55:53Z"
        }
      ]
    },
    {
      "number": 10,
      "id": "I_kwDONwrUhc6pk5iz",
      "title": "Diff vs self-contained document",
      "url": "https://github.com/lake-wg/psk/issues/10",
      "state": "OPEN",
      "author": "gselander",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "gselander"
      ],
      "labels": [],
      "body": "The current specification is written as a diff against RFC 9528. This is good from an economy of specification and may be good for a person who is familiar with RFC 9528, which anyway is assumed. \n\nHowever, it is difficult to read when you need to have RFC 9528 open on the side, and it isn't clear which parts of RFC 9528 that are not used. Moreover, since some terms are given a different definition and/or a different interpretation, there is risk for both confusion and potential errors.\n\nFor readability, some parts may not be repeated. This has the drawback when there is a need for update.\n\nWe should not have contradicting CDDL definitions between this spec and RFC 9528.\n\nAlso, the labeling of the parameters becomes confusing when the original meaning is lost, e.g. the \"2m\" part of PRK_3e2m does mean anything when there is no MAC in message 2. \n\nI'm in favor of defining new terms that makes sense for the new protocol, but also indicate what parts carry over directly from RFC 9528. Some overall refactoring is needed to carry out this. \n\n",
      "createdAt": "2025-02-11T10:53:32Z",
      "updatedAt": "2025-02-18T13:36:57Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 11,
      "id": "I_kwDONwrUhc6plSHE",
      "title": "Update title, abstract and intro",
      "url": "https://github.com/lake-wg/psk/issues/11",
      "state": "CLOSED",
      "author": "gselander",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "ElsaLopez133"
      ],
      "labels": [],
      "body": "Some proposed updates:\n\n* Title \n\nOLD\nEDHOC PSK Authentication\nNEW\nEDHOC authenticated with Pre-Shared Keys\n\nabbrev: \"EDHOC PSK\"\n\n* Abstract\n\nOLD\nThis document specifies the Pre-Shared Key (PSK) authentication method for the Ephemeral Diffie-Hellman Over COSE (EDHOC) key exchange protocol. It describes the authentication processes, message flows, and security considerations of this authentication method.\n\nNEW\nThis document specifies an authentication method for the Ephemeral Diffie-Hellman Over COSE (EDHOC) key exchange protocol based on Pre-Shared Keys (PSK). This method may be used for initial authentication and for resumption based on secret keys derived from a previously established EDHOC session.\n\nAlso, mention identity protection.\n\n* Intro\n\nRemove GBA, AKMA is sufficient to mention. Replace text with EAP with text about \n\nEAP-EDHOC plan to use this for resumption, include a \n reference.",
      "createdAt": "2025-02-11T11:34:56Z",
      "updatedAt": "2025-02-26T17:23:09Z",
      "closedAt": "2025-02-26T17:23:09Z",
      "comments": []
    },
    {
      "number": 12,
      "id": "I_kwDONwrUhc6plTUS",
      "title": "Privacy considerations",
      "url": "https://github.com/lake-wg/psk/issues/12",
      "state": "CLOSED",
      "author": "gselander",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "ElsaLopez133"
      ],
      "labels": [],
      "body": "This section is empty. Should at least talk about identity protection. ",
      "createdAt": "2025-02-11T11:37:11Z",
      "updatedAt": "2025-02-24T15:14:46Z",
      "closedAt": "2025-02-24T15:14:46Z",
      "comments": []
    },
    {
      "number": 13,
      "id": "I_kwDONwrUhc6plUGC",
      "title": "Section 8 is a security consideration",
      "url": "https://github.com/lake-wg/psk/issues/13",
      "state": "CLOSED",
      "author": "gselander",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "ElsaLopez133"
      ],
      "labels": [],
      "body": "Make this section a subsection of Security considerations",
      "createdAt": "2025-02-11T11:38:36Z",
      "updatedAt": "2025-02-18T13:36:30Z",
      "closedAt": "2025-02-18T13:36:30Z",
      "comments": []
    },
    {
      "number": 14,
      "id": "I_kwDONwrUhc6qX-7V",
      "title": "Reflection/selfie attacks",
      "url": "https://github.com/lake-wg/psk/issues/14",
      "state": "OPEN",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "emanjon"
      ],
      "labels": [],
      "body": "PSK authentication without identities is typically vulnerable to  reflection/Selfie attacks. Unless, we have some good reasons to believe that this is not the case we should probably mandate the inclusion of an identityin the sub field\n\n     2 : \"42-50-31-FF-EF-37-32-39\",               /sub/\n\nThis implies that there are two different \"CRED_PSK\"\n\n(Maybe this has been discussed and I missed it....)",
      "createdAt": "2025-02-17T17:12:26Z",
      "updatedAt": "2025-02-18T13:35:22Z",
      "closedAt": null,
      "comments": [
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Reflection attacks seems quite trivial unless something is added. 1. and 2. are two different sessions \n\n```\nInitiator                                            On-path Attacker\n|                1. METHOD, SUITES_I, G_X, C_I, EAD_1               |\n+------------------------------------------------------------------>|\n|                2. METHOD, SUITES_I, G_X, C_I, EAD_1               |\n<------------------------------------------------------------------+|\n|                             message_1                             |\n|                                                                   |\n|                   2. G_Y, Enc( C_R, EAD_2 )                       |\n+------------------------------------------------------------------>|\n|                   1. G_Y, Enc( C_R, EAD_2 )                       |\n|<------------------------------------------------------------------+\n|                             message_2                             |\n|                                                                   |\n|                1. Enc( ID_CRED_PSK, AEAD( EAD_3 ) )               |\n+------------------------------------------------------------------>|\n|                2. Enc( ID_CRED_PSK, AEAD( EAD_3 ) )               |\n|<------------------------------------------------------------------+\n|                             message_3                             |\n|                                                                   |\n|                         2. AEAD( EAD_4 )                          |\n+------------------------------------------------------------------>|\n|                         1. AEAD( EAD_4 )                          |\n|<------------------------------------------------------------------+\n|                             message_4                             |\n\n```\n\nI suggest that we mandate the use of two different identities in the sub field. The identities would not have to be sent but they would have to by included in \n\n```\n- TH_3 = H( TH_2, PLAINTEXT_2, CRED_PSK )\n- TH_4 = H( TH_3, ID_CRED_PSK, ? EAD_3, CRED_PSK )\n\n```",
          "createdAt": "2025-02-17T18:12:07Z",
          "updatedAt": "2025-02-17T18:14:59Z"
        },
        {
          "author": "emanjon",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Another approch that was discussed in the past was keeping a list of active G_X values, but this was abandoned due implementation complexities.",
          "createdAt": "2025-02-18T06:53:07Z",
          "updatedAt": "2025-02-18T06:53:07Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "Yes, I agree. I think having a list of active G_X is not worthy. Having two identifies should be fine. Or deriving two CRED_PSKs from the CRED_PSK: CRED_PSK_IR and CRED_PSK_RI",
          "createdAt": "2025-02-18T11:31:41Z",
          "updatedAt": "2025-02-18T11:31:41Z"
        }
      ]
    },
    {
      "number": 15,
      "id": "I_kwDONwrUhc6qYMfM",
      "title": "CRED_PSK, sub field, and key derivation",
      "url": "https://github.com/lake-wg/psk/issues/15",
      "state": "OPEN",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "emanjon"
      ],
      "labels": [],
      "body": "```\n{                                               /CCS/\n   2 : \"mydotbot\",                               /sub/\n   8 : {                                         /cnf/\n     1 : {                                       /COSE_Key/\n        1 : 4,                                   /kty/\n        2 : h'0f',                               /kid/\n       -1 : h'50930FF462A77A3540CF546325DEA214'  /k/\n     }\n   }\n }\n```\n\n- sub identifies I or R, not the PSK.\n\n- sub cannot be included in \n`PRK_4e3m    = EDHOC_Extract( SALT_4e3m, CRED_PSK )\n` ",
      "createdAt": "2025-02-17T17:38:29Z",
      "updatedAt": "2025-02-18T13:35:22Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 16,
      "id": "I_kwDONwrUhc6qdea6",
      "title": "Test vectors",
      "url": "https://github.com/lake-wg/psk/issues/16",
      "state": "OPEN",
      "author": "emanjon",
      "authorAssociation": "CONTRIBUTOR",
      "assignees": [
        "ElsaLopez133"
      ],
      "labels": [],
      "body": "Should have test vectors for EDHOC with PSK authentication. Does no need to be detailed as RFC 9529 but we should at a minimum have byte strings for\n\n- CRED_PSK\n- message_1\n- message_2\n- message_3\n- message_4\n",
      "createdAt": "2025-02-18T09:37:40Z",
      "updatedAt": "2025-02-18T13:34:55Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 17,
      "id": "I_kwDONwrUhc6qgFur",
      "title": "Issue in TH_3 Calculation",
      "url": "https://github.com/lake-wg/psk/issues/17",
      "state": "CLOSED",
      "author": "francislopezg",
      "authorAssociation": "NONE",
      "assignees": [],
      "labels": [],
      "body": "Hi all, \nI have identified a potential issue in the calculation of Transcript Hash 3 (TH_3) in the draft specification. TH_3 is defined as follows:\n\n **TH_3 = H( TH_2, PLAINTEXT_2, CRED_PSK )**\n\nTH_3 is then used to generate KEYSTREAM_3:\n\n **KEYSTREAM_3   = EDHOC_KDF( PRK_3e2m,    TBD, TH_3,  ID_CRED_PSK length )**\n\nKEYSTREAM_3 is used by the Initiator to encrypt ID_CRED_PSK before sending it in message_3. Consequently, the Responder needs to derive the same KEYSTREAM_3 to decrypt ID_CRED_PSK when processing message_3.\n\nThe issue is that TH_3 already includes CRED_PSK. However, the Responder requires KEYSTREAM_3 to decrypt ID_CRED_PSK and determine which PSK should be used. This creates a circular dependency:\n \n 1. To derive KEYSTREAM_3, the Responder must first compute TH_3.\n 2. Computing TH_3 requires CRED_PSK, which depends on knowing the correct PSK.\n 3. However, the Responder can only determine the correct PSK after decrypting ID_CRED_PSK using KEYSTREAM_3.",
      "createdAt": "2025-02-18T13:57:23Z",
      "updatedAt": "2025-05-01T19:39:55Z",
      "closedAt": "2025-05-01T19:39:55Z",
      "comments": [
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "How about this?\n\nTH_3 = H(TH_2, PLAINTEXT_2)\nexternal_aad = << Enc(ID_CRED_PSK), TH_3, CRED_PSK >>",
          "createdAt": "2025-02-24T12:45:54Z",
          "updatedAt": "2025-02-24T12:45:54Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "With the new format of message_3 would be:\n\n\nTH_3 = H(TH_2, PLAINTEXT_2)\nexternal_aad = << ID_CRED_PSK, TH_3, CRED_PSK >>",
          "createdAt": "2025-02-25T15:48:44Z",
          "updatedAt": "2025-02-25T15:48:44Z"
        },
        {
          "author": "rml1977",
          "authorAssociation": "CONTRIBUTOR",
          "body": "I have fixed this in the text",
          "createdAt": "2025-02-26T07:14:39Z",
          "updatedAt": "2025-02-26T07:14:39Z"
        }
      ]
    }
  ],
  "pulls": []
}