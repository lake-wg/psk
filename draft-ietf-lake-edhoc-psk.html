<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>EDHOC Authenticated with Pre‑Shared Keys (PSK)</title>
<meta content="Elsa Lopez-Perez" name="author">
<meta content="Göran Selander" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Rafael Marin-Lopez" name="author">
<meta content="
       This document specifies a Pre-Shared Key (PSK) authentication method for the Ephemeral Diffie-Hellman Over COSE (EDHOC) key exchange protocol. The PSK method enhances computational efficiency while providing mutual authentication, ephemeral key exchange, identity protection, and quantum resistance. It is particularly suited for systems where nodes share a PSK provided out-of-band (external PSK) and enables efficient session resumption with less computational overhead when the PSK is provided from a previous EDHOC session (resumption PSK). This document details the PSK method flow, key derivation changes, message formatting, processing, and security considerations. 
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="draft-ietf-lake-edhoc-psk-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-lake-edhoc-psk.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EDHOC-PSK</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lopez-Perez, et al.</td>
<td class="center">Expires 21 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">LAKE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-lake-edhoc-psk-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-19" class="published">19 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-21">21 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">E. Lopez-Perez</div>
<div class="org">Inria</div>
</div>
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">R. Marin-Lopez</div>
<div class="org">University of Murcia</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">EDHOC Authenticated with Pre‑Shared Keys (PSK)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a Pre-Shared Key (PSK) authentication method for the Ephemeral Diffie-Hellman Over COSE (EDHOC) key exchange protocol. The PSK method enhances computational efficiency while providing mutual authentication, ephemeral key exchange, identity protection, and quantum resistance. It is particularly suited for systems where nodes share a PSK provided out-of-band (external PSK) and enables efficient session resumption with less computational overhead when the PSK is provided from a previous EDHOC session (resumption PSK). This document details the PSK method flow, key derivation changes, message formatting, processing, and security considerations.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://lake-wg.github.io/psk/#go.draft-ietf-lake-edhoc-psk.html">https://lake-wg.github.io/psk/#go.draft-ietf-lake-edhoc-psk.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-lake-edhoc-psk/">https://datatracker.ietf.org/doc/draft-ietf-lake-edhoc-psk/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        LAKE Working Group mailing list (<span><a href="mailto:lake@ietf.org">mailto:lake@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/lake/">https://mailarchive.ietf.org/arch/browse/lake/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/lake/">https://www.ietf.org/mailman/listinfo/lake/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/lake-wg/psk">https://github.com/lake-wg/psk</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol" class="internal xref">Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-credentials" class="internal xref">Credentials</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-message-flow-of-edhoc-psk" class="internal xref">Message Flow of EDHOC-PSK</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-key-derivation" class="internal xref">Key Derivation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-message-formatting-and-proc" class="internal xref">Message Formatting and Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-message-1" class="internal xref">Message 1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-message-2" class="internal xref">Message 2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-formatting-of-message-2" class="internal xref">Formatting of Message 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-responder-composition-of-me" class="internal xref">Responder Composition of Message 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-initiator-processing-of-mes" class="internal xref">Initiator Processing of Message 2</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-message-3" class="internal xref">Message 3</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-formatting-of-message-3" class="internal xref">Formatting of Message 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-initiator-composition-of-me" class="internal xref">Initiator Composition of Message 3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="auto internal xref">5.3.3</a>.  <a href="#name-responder-processing-of-mes" class="internal xref">Responder Processing of Message 3</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-message-4" class="internal xref">Message 4</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-psk-usage-for-session-resum" class="internal xref">PSK usage for Session Resumption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-cipher-suite-requirements-f" class="internal xref">Cipher Suite Requirements for Resumption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-privacy-considerations-for-" class="internal xref">Privacy Considerations for Resumption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-security-considerations-for" class="internal xref">Security Considerations for Resumption</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-identity-protection" class="internal xref">Identity protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-mutual-authentication" class="internal xref">Mutual Authentication</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-external-authorization-data" class="internal xref">External Authorization Data Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-post-quantum-considerations" class="internal xref">Post Quantum Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-independence-of-session-key" class="internal xref">Independence of Session Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-unified-approach-and-recomm" class="internal xref">Unified Approach and Recommendations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-edhoc-method-type-registry" class="internal xref">EDHOC Method Type Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-edhoc-exporter-label-regist" class="internal xref">EDHOC Exporter Label Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-cddl-definitions" class="internal xref">CDDL Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-message_1" class="internal xref">message_1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-message_2" class="internal xref">message_2</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-message_3" class="internal xref">message_3</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-message_4" class="internal xref">message_4</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-change-log" class="internal xref">Change Log</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines a Pre-Shared Key (PSK) authentication method for the Ephemeral Diffie-Hellman Over COSE (EDHOC) key exchange protocol <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The PSK method balances the complexity of credential distribution with computational efficiency. While symmetrical key distribution is more complex than asymmetrical approaches, PSK authentication offers greater computational efficiency compared to the methods outlined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The PSK method retains mutual authentication, asymmetric ephemeral key exchange, and identity protection established by <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">EDHOC with PSK authentication benefits use cases where two nodes share a Pre-Shared Key (PSK) provided out-of-band (external PSK). This applies to scenarios like the Authenticated Key Management Architecture (AKMA) in mobile systems or the Peer and Authenticator in Extensible Authentication Protocol (EAP) systems. The PSK method enables the nodes to perform ephemeral key exchange, achieving Perfect Forward Secrecy (PFS). This ensures that even if the PSK is compromised, past communications remain secure against active attackers, while future communications are protected from passive attackers. Additionally, by leveraging the PSK for both authentication and key derivation, the method offers quantum resistance key exchange and authentication even when used with ECDHE.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Another key use case of PSK authentication in the EDHOC protocol is session resumption. This enables previously connected parties to quickly reestablish secure communication using pre-shared keys from a prior session, reducing the overhead associated with key exchange and asymmetric authentication. By using PSK authentication, EDHOC allows session keys to be refreshed with significantly lower computational overhead compared to public-key authentication. In this case, the PSK (resumption PSK) is provisioned after the establishment of a previous EDHOC session by using EDHOC_Exporter (resumption PSK).<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Therefore, the external PSK is supposed to be a long-term credential while the resumption PSK is a session key.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Section 3 provides an overview of the PSK method flow and credentials. Section 4 outlines the changes to key derivation compared to <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, Section 5 details message formatting and processing, and Section 6 discusses security considerations. How to derive keys for resumption is described in Section 7.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Readers are expected to be familiar with the terms and concepts described in EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, CBOR Sequences <span>[<a href="#RFC8742" class="cite xref">RFC8742</a>]</span>, COSE Structures and Processing <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span>, COSE Algorithms <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, CWT and CCS <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>, and the Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>, which is used to express CBOR data structures.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol">
<section id="section-3">
      <h2 id="name-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol" class="section-name selfRef">Protocol</a>
      </h2>
<p id="section-3-1">In this method, the Pre-Shared Key identifier (ID_CRED_PSK), which allows retrieval of the CRED_PSK, is sent in message_3. CRED_PSK is an authentication credential associated with the PSK. Although it may use a COSE_Key representation for compatibility, the format is not restricted to COSE_Key and can vary depending on the implementation. Through this document we will refer to the Pre-Shared Key authentication method as EDHOC-PSK.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="credentials">
<section id="section-3.1">
        <h3 id="name-credentials">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-credentials" class="section-name selfRef">Credentials</a>
        </h3>
<p id="section-3.1-1">Initiator and Responder are assumed to have a PSK (external PSK or resumption PSK) with good amount of randomness and the requirements that:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">Only the Initiator and the Responder have access to the PSK.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">The Responder is able to retrieve CRED_PSK and the PSK, using ID_CRED_PSK.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-3">where:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">
            <p id="section-3.1-4.1.1">ID_CRED_PSK is a COSE header map containing header parameters that can identify a pre-shared key. For example:<a href="#section-3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-3.1-5">
<pre>
ID_CRED_PSK = {4 : h'0f' }
</pre><a href="#section-3.1-5" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-3.1-6.1">
            <p id="section-3.1-6.1.1">CRED_PSK is an authentication credential that identifies the PSK. It is often represented as a CBOR Web Token (CWT) or CWT Claims Set (CCS) <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span> whose 'cnf' claim uses the confirmation method 'COSE_Key' to carry the PSK. However, other formats for CRED_PSK are also allowed, as long as they enable the recipient to identify and retrieve the correct PSK. An example of CRED_PSK would be:<a href="#section-3.1-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-3.1-7">
<pre>
{                                               /CCS/
  2 : "mydotbot",                               /sub/
  8 : {                                         /cnf/
    1 : {                                       /COSE_Key/
       1 : 4,                                   /kty/
       2 : h'0f',                               /kid/
      -1 : h'50930FF462A77A3540CF546325DEA214'  /k/
    }
  }
}
</pre><a href="#section-3.1-7" class="pilcrow">¶</a>
</div>
<p id="section-3.1-8">The purpose of ID_CRED_PSK is to facilitate the retrieval of the PSK.
It is <span class="bcp14">RECOMMENDED</span> that it uniquely identifies the CRED_PSK as the recipient might otherwise have to try several keys.
If ID_CRED_PSK contains a single 'kid' parameter, then the compact encoding is applied; see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3.2" class="relref">Section 3.5.3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.
The authentication credential CRED_PSK substitutes CRED_I and CRED_R specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, and, when applicable, <span class="bcp14">MUST</span> follow the same guidelines described in Section <a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.2" class="relref">3.5.2</a> and Section <a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3" class="relref">3.5.3</a> of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-flow-of-edhoc-psk">
<section id="section-3.2">
        <h3 id="name-message-flow-of-edhoc-psk">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-message-flow-of-edhoc-psk" class="section-name selfRef">Message Flow of EDHOC-PSK</a>
        </h3>
<p id="section-3.2-1">The ID_CRED_PSK is sent in message_3, encrypted using a key derived from the ephemeral shared secret, G_XY, calculated from the Initiator's ephemeral public key G_X or from the encapsulation G_Y and the private key corresponding to G_X. When ECDHE is used, the encapsulation G_Y is the Responder's ephemeral public key. The Responder authenticates the Initiator first. <a href="#fig-variant2" class="auto internal xref">Figure 1</a> shows the message flow of the EDHOC-PSK authentication method.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span id="name-overview-of-message-flow-of"></span><div id="fig-variant2">
<figure id="figure-1">
          <div id="section-3.2-2.1">
            <div class="alignCenter art-svg artwork" id="section-3.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="288" width="560" viewBox="0 0 560 288" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 8,272" fill="none" stroke="black"></path>
                <path d="M 552,48 L 552,272" fill="none" stroke="black"></path>
                <path d="M 8,64 L 544,64" fill="none" stroke="black"></path>
                <path d="M 16,128 L 552,128" fill="none" stroke="black"></path>
                <path d="M 8,192 L 544,192" fill="none" stroke="black"></path>
                <path d="M 16,256 L 552,256" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="552,192 540,186.4 540,197.6" fill="black" transform="rotate(0,544,192)"></polygon>
                <polygon class="arrowhead" points="552,64 540,58.4 540,69.6" fill="black" transform="rotate(0,544,64)"></polygon>
                <polygon class="arrowhead" points="24,256 12,250.4 12,261.6" fill="black" transform="rotate(180,16,256)"></polygon>
                <polygon class="arrowhead" points="24,128 12,122.4 12,133.6" fill="black" transform="rotate(180,16,128)"></polygon>
                <g class="text">
                  <text x="40" y="36">Initiator</text>
                  <text x="520" y="36">Responder</text>
                  <text x="184" y="52">METHOD,</text>
                  <text x="256" y="52">SUITES_I,</text>
                  <text x="316" y="52">G_X,</text>
                  <text x="356" y="52">C_I,</text>
                  <text x="400" y="52">EAD_1</text>
                  <text x="280" y="84">message_1</text>
                  <text x="204" y="116">G_Y,</text>
                  <text x="244" y="116">Enc(</text>
                  <text x="284" y="116">C_R,</text>
                  <text x="328" y="116">EAD_2</text>
                  <text x="360" y="116">)</text>
                  <text x="280" y="148">message_2</text>
                  <text x="180" y="180">Enc(</text>
                  <text x="252" y="180">ID_CRED_PSK,</text>
                  <text x="328" y="180">AEAD(</text>
                  <text x="376" y="180">EAD_3</text>
                  <text x="408" y="180">)</text>
                  <text x="424" y="180">)</text>
                  <text x="280" y="212">message_3</text>
                  <text x="248" y="244">AEAD(</text>
                  <text x="296" y="244">EAD_4</text>
                  <text x="328" y="244">)</text>
                  <text x="280" y="276">message_4</text>
                </g>
              </svg><a href="#section-3.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-overview-of-message-flow-of" class="selfRef">Overview of Message Flow of EDHOC-PSK.</a>
          </figcaption></figure>
</div>
<p id="section-3.2-3">This approach provides identity protection against passive attackers for both Initiator and Responder.
message_4 remains optional, but is needed to authenticate the Responder and achieve mutual authentication in EDHOC if not relying on external applications, such as OSCORE. With this fourth message, the protocol achieves both explicit key confirmation and mutual authentication.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-der">
<section id="section-4">
      <h2 id="name-key-derivation">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-key-derivation" class="section-name selfRef">Key Derivation</a>
      </h2>
<p id="section-4-1">The pseudorandom keys (PRKs) used for the PSK authentication method in EDHOC are derived using EDHOC_Extract, as done in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-2">
<pre>
PRK  = EDHOC_Extract( salt, IKM )
</pre><a href="#section-4-2" class="pilcrow">¶</a>
</div>
<p id="section-4-3">where <code>salt</code> and input keying material (<code>IKM</code>) are defined for each key.
The definition of EDHOC_Extract depends on the EDHOC hash algorithm selected in the cipher suite, see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The transcript hash TH_2 = H( G_Y, H(message_1) ) is defined as in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.3.2" class="relref">Section 5.3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, the others are modified as specified below.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5"><a href="#fig-variant2key" class="auto internal xref">Figure 2</a> lists the key derivations that differ from those specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The following data is used as in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>:<a href="#section-4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-6.1">
          <p id="section-4-6.1.1">PRK_2e is extracted with<a href="#section-4-6.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-6.1.2.1">
              <p id="section-4-6.1.2.1.1"><code>salt</code> = TH_2, and<a href="#section-4-6.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4-6.1.2.2">
              <p id="section-4-6.1.2.2.1"><code>IKM</code> = G_XY.<a href="#section-4-6.1.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="section-4-6.2">
          <p id="section-4-6.2.1">KEYSTREAM_2 is derived from PRK_2e and TH_2, see Figure 6 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-6.3">
          <p id="section-4-6.3.1">SALT_4e3m is derived from PRK_3e2m and TH_3, see Figure 6 of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<span id="name-key-derivation-of-edhoc-psk"></span><div id="fig-variant2key">
<figure id="figure-2">
        <div class="alignCenter art-text artwork" id="section-4-7.1">
<pre>
PRK_3e2m    = PRK_2e
PRK_4e3m    = EDHOC_Extract( SALT_4e3m, CRED_PSK )
KEYSTREAM_3 = EDHOC_KDF( PRK_3e2m, 11, TH_3, plaintext_length_3 )
K_3         = EDHOC_KDF( PRK_4e3m, 3, TH_3, key_length )
IV_3        = EDHOC_KDF( PRK_4e3m, 4, TH_3, iv_length )
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-key-derivation-of-edhoc-psk" class="selfRef">Key Derivation of EDHOC-PSK.</a>
        </figcaption></figure>
</div>
<p id="section-4-8">where:<a href="#section-4-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-9.1">
          <p id="section-4-9.1.1">KEYSTREAM_3 is used to encrypt the ID_CRED_PSK in message_3.<a href="#section-4-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-9.2">
          <p id="section-4-9.2.1">TH_3 = H( TH_2, PLAINTEXT_2 )<a href="#section-4-9.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-10">Additionally, the definition of the transcript hash TH_4 is modified as:<a href="#section-4-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-11.1">
          <p id="section-4-11.1.1">TH_4 = H( TH_3, ID_CRED_PSK, PLAINTEXT_3B, CRED_PSK )<a href="#section-4-11.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="message-formatting-and-processing">
<section id="section-5">
      <h2 id="name-message-formatting-and-proc">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-message-formatting-and-proc" class="section-name selfRef">Message Formatting and Processing</a>
      </h2>
<p id="section-5-1">This section specifies the differences in message formatting and processing compared to <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5" class="relref">Section 5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="message-1">
<section id="section-5.1">
        <h3 id="name-message-1">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-message-1" class="section-name selfRef">Message 1</a>
        </h3>
<p id="section-5.1-1">Message 1 is formatted and processed as specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-2">
<section id="section-5.2">
        <h3 id="name-message-2">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-message-2" class="section-name selfRef">Message 2</a>
        </h3>
<div id="formatting-of-message-2">
<section id="section-5.2.1">
          <h4 id="name-formatting-of-message-2">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-formatting-of-message-2" class="section-name selfRef">Formatting of Message 2</a>
          </h4>
<p id="section-5.2.1-1">Message 2 is formatted as specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.3.1" class="relref">Section 5.3.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="responder-composition-of-message-2">
<section id="section-5.2.2">
          <h4 id="name-responder-composition-of-me">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-responder-composition-of-me" class="section-name selfRef">Responder Composition of Message 2</a>
          </h4>
<p id="section-5.2.2-1">CIPHERTEXT_2 is calculated with a binary additive stream cipher, using a keystream generated with EDHOC_Expand, and the following plaintext:<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.1">
              <p id="section-5.2.2-2.1.1">PLAINTEXT_2B = ( C_R, ? EAD_2 )<a href="#section-5.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-2.2">
              <p id="section-5.2.2-2.2.1">CIPHERTEXT_2 = PLAINTEXT_2B XOR KEYSTREAM_2<a href="#section-5.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.2.2-3">Contrary to <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, ID_CRED_R, MAC_2, and Signature_or_MAC_2 are not used. C_R, EAD_2, and KEYSTREAM_2 are defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.3.2" class="relref">Section 5.3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initiator-processing-of-message-2">
<section id="section-5.2.3">
          <h4 id="name-initiator-processing-of-mes">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-initiator-processing-of-mes" class="section-name selfRef">Initiator Processing of Message 2</a>
          </h4>
<p id="section-5.2.3-1">Compared to <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.3.3" class="relref">Section 5.3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, ID_CRED_R is not made available to the application in step 4, and steps 5 and 6 are skipped<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="message-3">
<section id="section-5.3">
        <h3 id="name-message-3">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-message-3" class="section-name selfRef">Message 3</a>
        </h3>
<div id="formatting-of-message-3">
<section id="section-5.3.1">
          <h4 id="name-formatting-of-message-3">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-formatting-of-message-3" class="section-name selfRef">Formatting of Message 3</a>
          </h4>
<p id="section-5.3.1-1">Message 3 is formatted as specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.1" class="relref">Section 5.4.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initiator-composition-of-message-3">
<section id="section-5.3.2">
          <h4 id="name-initiator-composition-of-me">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-initiator-composition-of-me" class="section-name selfRef">Initiator Composition of Message 3</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.3.2-1.1">
              <p id="section-5.3.2-1.1.1">CIPHERTEXT_3 is calculated with a binary additive stream cipher, using a keystream generated with EDHOC_Expand, and the following plaintext:<a href="#section-5.3.2-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-1.1.2.1">
                  <p id="section-5.3.2-1.1.2.1.1">PLAINTEXT_3A = ( ID_CRED_PSK / bstr / -24..23, CIPHERTEXT_3B )<a href="#section-5.3.2-1.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-1.1.2.1.2.1">
                      <p id="section-5.3.2-1.1.2.1.2.1.1">If ID_CRED_PSK contains a single 'kid' parameter, i.e., ID_CRED_PSK = { 4 : kid_PSK }, then the compact encoding is applied, see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3.2" class="relref">Section 3.5.3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5.3.2-1.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.3.2-1.1.2.1.2.2">
                      <p id="section-5.3.2-1.1.2.1.2.2.1">If the length of PLAINTEXT_3A exceeds the output of EDHOC_KDF, then <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> applies.<a href="#section-5.3.2-1.1.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-5.3.2-1.1.2.2">
                  <p id="section-5.3.2-1.1.2.2.1">Compute KEYSTREAM_3 as in <a href="#key-der" class="auto internal xref">Section 4</a>, where plaintext_length is the length of PLAINTEXT_3A.<a href="#section-5.3.2-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.2-1.1.2.3">
                  <p id="section-5.3.2-1.1.2.3.1">CIPHERTEXT_3 = PLAINTEXT_3A XOR KEYSTREAM_3<a href="#section-5.3.2-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.3.2-1.2">
              <p id="section-5.3.2-1.2.1">CIPHERTEXT_3B is the 'ciphertext' of COSE_Encrypt0 object as defined in Section <a href="https://rfc-editor.org/rfc/rfc9528#section-5.2" class="relref">5.2</a> and Section <a href="https://rfc-editor.org/rfc/rfc9528#section-5.3" class="relref">5.3</a> of <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, with the EDHOC AEAD algorithm of the selected cipher suite, using the encryption key K_3, the initialization vector IV_3 (if used by the AEAD algorithm), the parameters described in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, plaintext PLAINTEXT_3B and the following parameters as input:<a href="#section-5.3.2-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-1.2.2.1">
                  <p id="section-5.3.2-1.2.2.1.1">protected = h''<a href="#section-5.3.2-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.2-1.2.2.2">
                  <p id="section-5.3.2-1.2.2.2.1">external_aad = &lt;&lt; ID_CRED_PSK, TH_3, CRED_PSK &gt;&gt;<a href="#section-5.3.2-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.2-1.2.2.3">
                  <p id="section-5.3.2-1.2.2.3.1">K_3 and IV_3 as defined in <a href="#key-der" class="auto internal xref">Section 4</a><a href="#section-5.3.2-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.2-1.2.2.4">
                  <p id="section-5.3.2-1.2.2.4.1">PLAINTEXT_3B = ( ? EAD_3 )<a href="#section-5.3.2-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-5.3.2-2">The Initiator computes TH_4 = H( TH_3, ID_CRED_PSK, PLAINTEXT_3B, CRED_PSK ), defined in <a href="#key-der" class="auto internal xref">Section 4</a>.<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="responder-processing-of-message-3">
<section id="section-5.3.3">
          <h4 id="name-responder-processing-of-mes">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-responder-processing-of-mes" class="section-name selfRef">Responder Processing of Message 3</a>
        </h4>
</section>
</div>
</section>
</div>
<div id="message-4">
<section id="section-5.4">
        <h3 id="name-message-4">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-message-4" class="section-name selfRef">Message 4</a>
        </h3>
<p id="section-5.4-1">Message 4 is formatted and processed as specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Compared to <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, a fourth message does not only provide key confirmation but also Responder authentication. To authenticate the Responder and achieve mutual authentication, a fourth message is mandatory.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">After verifying message_4, the Initiator is assured that the Responder has calculated the key PRK_out (key confirmation) and that no other party can derive the key. The Initiator <span class="bcp14">MUST NOT</span> persistently store PRK_out or application keys until the Initiator has verified message_4 or a message protected with a derived application key, such as an OSCORE message, from the Responder and the application has authenticated the Responder.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="psk-resumption">
<section id="section-6">
      <h2 id="name-psk-usage-for-session-resum">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-psk-usage-for-session-resum" class="section-name selfRef">PSK usage for Session Resumption</a>
      </h2>
<p id="section-6-1">This section defines how PSKs are used for session resumption in EDHOC.
Following <span><a href="https://rfc-editor.org/rfc/rfc9528#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, EDHOC_Exporter can be used to derive both CRED_PSK and ID_CRED_PSK:<a href="#section-6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-2">
<pre>
CRED_PSK = EDHOC_Exporter( 2, h'', resumption_psk_length )
ID_CRED_PSK = EDHOC_Exporter( 3, h'', id_cred_psk_length )
</pre><a href="#section-6-2" class="pilcrow">¶</a>
</div>
<p id="section-6-3">where:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">
          <p id="section-6-4.1.1">resumption_psk_length is by default the key_length (length of the encryption key of the EDHOC AEAD algorithm of the selected cipher suite) of the session in which the EDHOC_Exporter is called.<a href="#section-6-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.2">
          <p id="section-6-4.2.1">id_cred_psk_length is by default 2.<a href="#section-6-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-6-5">A peer that has successfully completed an EDHOC session, regardless of the used authentication method, <span class="bcp14">MUST</span> generate a resumption key to use for the next resumption in the present "session series", as long as it supports PSK resumption.
To guarantee that both peers share the same resumption key, when a session is run using rPSK_i as a resumption key
  - The Initiator can delete rPSK_i after having successfully verified EDHOC message_4.
    In this case, the Responder will have derived the next rPSK_(i+1), which the Initiator can know for sure, upon receiving EDHOC message_4.
  - The Responder can delete rPSK_(i-1), if any, after having successfully sent EDHOC message_4.
    That is, upon receiving EDHOC message_3, the Responder knows for sure that the other peer did derive rPSK_i at the end of the previous session in the "session series", thus making it safe to delete the previous resumption key rPSK_(i-1).<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="cipher-suite-requirements-for-resumption">
<section id="section-6.1">
        <h3 id="name-cipher-suite-requirements-f">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-cipher-suite-requirements-f" class="section-name selfRef">Cipher Suite Requirements for Resumption</a>
        </h3>
<p id="section-6.1-1">When using a resumption PSK derived from a previous EDHOC exchange:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-2">
<li id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">The resumption PSK <span class="bcp14">MUST</span> only be used with the same cipher suite that was used in the original EDHOC exchange, or with a cipher suite that provides equal or higher security guarantees.<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">Implementations <span class="bcp14">SHOULD</span> maintain a mapping between the resumption PSK and its originating cipher suite to enforce this requirement.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-2.3">
            <p id="section-6.1-2.3.1">If a resumption PSK is offered with a cipher suite different from the one used in the original EDHOC session, the recipient can fail the present EDHOC session according to application-specific policies.<a href="#section-6.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="privacy-considerations-for-resumption">
<section id="section-6.2">
        <h3 id="name-privacy-considerations-for-">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-privacy-considerations-for-" class="section-name selfRef">Privacy Considerations for Resumption</a>
        </h3>
<p id="section-6.2-1">When using resumption PSKs:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">The same ID_CRED_PSK is reused each time EDHOC is executed with a specific resumption PSK.<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">To prevent long-term tracking, implementations <span class="bcp14">SHOULD</span> periodically initiate a full EDHOC exchange to generate a new resumption PSK and corresponding ID_CRED_PSK. Alternatively, as stated in <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-H" class="relref">Appendix H</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, EDHOC_KeyUpdate can be used to derive a new PRK_out, and consequently a new CRED_PSK and ID_CRED_PSK for session resumption.<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="security-considerations-for-resumption">
<section id="section-6.3">
        <h3 id="name-security-considerations-for">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-security-considerations-for" class="section-name selfRef">Security Considerations for Resumption</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-6.3-1.1">
            <p id="section-6.3-1.1.1">Resumption PSKs <span class="bcp14">MUST NOT</span> be used for purposes other than EDHOC session resumption.<a href="#section-6.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-1.2">
            <p id="section-6.3-1.2.1">Resumption PSKs <span class="bcp14">MUST</span> be securely stored with the same level of protection as the original session keys.<a href="#section-6.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-1.3">
            <p id="section-6.3-1.3.1">Parties <span class="bcp14">SHOULD</span> implement mechanisms to detect and prevent excessive reuse of the same resumption PSK.<a href="#section-6.3-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">The EDHOC-PSK authentication method introduces changes with respect to the current specification of EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. This section analyzes the security implications of these changes.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="identity-protection">
<section id="section-7.1">
        <h3 id="name-identity-protection">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-identity-protection" class="section-name selfRef">Identity protection</a>
        </h3>
<p id="section-7.1-1">EDHOC-PSK encrypts ID_CRED_PSK in message 3 with a keystream derived from the ephemeral shared secret G_XY. As a consequence, contrary to the current EDHOC methods that protect the Initiator’s identity against active attackers and the Responder’s identity against passive attackers (See <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), EDHOC-PSK provides identity protection for both the Initiator and the Responder against passive attackers.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mutual-authentication">
<section id="section-7.2">
        <h3 id="name-mutual-authentication">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-mutual-authentication" class="section-name selfRef">Mutual Authentication</a>
        </h3>
<p id="section-7.2-1">EDHOC-PSK provides mutual authentication, assuming the PSK remains secret. However, if the optional fourth message (message_4) is omitted, mutual authentication is not guaranteed—unless the Responder is later authenticated through an OSCORE message or other application data demonstrating possession of the PSK. When message_4 is included, the protocol ensures both mutual authentication and explicit key confirmation.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="external-authorization-data-protection">
<section id="section-7.3">
        <h3 id="name-external-authorization-data">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-external-authorization-data" class="section-name selfRef">External Authorization Data Protection</a>
        </h3>
<p id="section-7.3-1">Similarly to <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, EDHOC-PSK provides external authorization data protection. The integrity and confidentiality of EAD fields follow the same security guarantees as in the original EDHOC specification.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="post-quantum-considerations">
<section id="section-7.4">
        <h3 id="name-post-quantum-considerations">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-post-quantum-considerations" class="section-name selfRef">Post Quantum Considerations</a>
        </h3>
<p id="section-7.4-1">Recent advancements in quantum computing suggest that the development of a Cryptographically Relevant Quantum Computer (CRQC) is likely feasible long-term. If realized, such a machine would render many currently deployed asymmetric cryptographic algorithms—such as Elliptic Curve Diffie-Hellman (ECDH)—insecure.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">By leveraging a symmetric PSK for both authentication and key derivation, EDHOC-PSK provides quantum-resistant key exchange and authentication, even when used with ECDHE. However, if a cryptographically relevant quantum computer (CRQC) is realized, the ECDHE component would be broken and contribute only randomness. Consequently, EDHOC-PSK with ECDHE does not offer identity protection or Perfect Forward Secrecy (PFS) against quantum-capable adversaries. If the PSK is compromised, a passive quantum attacker could decrypt both past and future sessions. In contrast, EDHOC-PSK combined with a quantum-resistant Key Encapsulation Mechanism (KEM), such as ML-KEM, provides identity protection and PFS even in the presence of a quantum attacker.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="independence-of-session-keys">
<section id="section-7.5">
        <h3 id="name-independence-of-session-key">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-independence-of-session-key" class="section-name selfRef">Independence of Session Keys</a>
        </h3>
<p id="section-7.5-1">NIST mandates that an ephemeral private key shall be used in exactly one key-establishment transaction (see Section 5.6.3.3 of <span>[<a href="#SP-800-56A" class="cite xref">SP-800-56A</a>]</span>). This requirement is essential for preserving session key independence and ensuring forward secrecy. The EDHOC-PSK protocol complies with this NIST requirement.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">In other protocols, the reuse of ephemeral keys, particularly when combined with implementation flaws such as the absence of public key validation, has resulted in critical security vulnerabilities. Such weaknesses have allowed attackers to recover the so called “ephemeral” private key from a compromised session, thereby enabling them to compromise the security of both past and future sessions between legitimate parties. Assuming breach and minimizing the impact of compromise are fundamental zero-trust principles.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unified-approach-and-recommendations">
<section id="section-7.6">
        <h3 id="name-unified-approach-and-recomm">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-unified-approach-and-recomm" class="section-name selfRef">Unified Approach and Recommendations</a>
        </h3>
<p id="section-7.6-1">For use cases involving the transmission of application data, application data can be sent concurrently with message_3, maintaining the protocol's efficiency.
In applications such as EAP-EDHOC, where application data is not sent, message_4 is mandatory. Thus, the EDHOC-PSK authentication method does not include any extra messages.
Other implementations may continue using OSCORE in place of EDHOC message_4, with a required change in the protocol's language to:
      The Initiator <span class="bcp14">SHALL NOT</span> persistently store PRK_out or application keys until the Initiator has verified message_4 or a message protected with a derived application key, such as an OSCORE message.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<p id="section-7.6-2">This change ensures that key materials are only stored once their integrity and authenticity are confirmed, thereby enhancing privacy by preventing early storage of potentially compromised keys.<a href="#section-7.6-2" class="pilcrow">¶</a></p>
<p id="section-7.6-3">Lastly, whether the Initiator or Responder authenticates first is not relevant when using symmetric keys.
This consideration was important for the privacy properties when using asymmetric authentication but is not significant in the context of symmetric key usage.<a href="#section-7.6-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="edhoc-method-type-registry">
<section id="section-8.1">
        <h3 id="name-edhoc-method-type-registry">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-edhoc-method-type-registry" class="section-name selfRef">EDHOC Method Type Registry</a>
        </h3>
<p id="section-8.1-1">IANA is requested to register the following entry in the "EDHOC Method Type" registry under the group name "Ephemeral Diffie-Hellman Over OCSE (EDHOC)".<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span id="name-addition-to-the-edhoc-metho"></span><div id="tab-method-psk">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-addition-to-the-edhoc-metho" class="selfRef">Addition to the EDHOC Method Type Registry.</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Initiator Authentication Key</th>
              <th class="text-left" rowspan="1" colspan="1">Responder Authentication Key</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">PSK</td>
              <td class="text-left" rowspan="1" colspan="1">PSK</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="edhoc-exporter-label-registry">
<section id="section-8.2">
        <h3 id="name-edhoc-exporter-label-regist">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-edhoc-exporter-label-regist" class="section-name selfRef">EDHOC Exporter Label Registry</a>
        </h3>
<p id="section-8.2-1">IANA is requested to register the following entry in the "EDHOC Exporter Label" registry under the group name "Ephemeral Diffie-Hellman Over OCSE (EDHOC)".<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-additions-to-the-edhoc-expo"></span><div id="tab-exporter-psk">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-additions-to-the-edhoc-expo" class="selfRef">Additions to the EDHOC Exporter Label Registry.</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Label</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Change Controller</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Resumption CRED_PSK</td>
              <td class="text-left" rowspan="1" colspan="1">IETF</td>
              <td class="text-left" rowspan="1" colspan="1">Section 7</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Resumption ID_CRED_PSK</td>
              <td class="text-left" rowspan="1" colspan="1">IETF</td>
              <td class="text-left" rowspan="1" colspan="1">Section 7</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="sec-normative-references">
<section id="section-9">
      <h2 id="name-normative-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8742">[RFC8742]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Sequences"</span>, <span class="seriesInfo">RFC 8742</span>, <span class="seriesInfo">DOI 10.17487/RFC8742</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8742">https://www.rfc-editor.org/rfc/rfc8742</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9053">[RFC9053]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="seriesInfo">RFC 9053</span>, <span class="seriesInfo">DOI 10.17487/RFC9053</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9053">https://www.rfc-editor.org/rfc/rfc9053</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9528">[RFC9528]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SP-800-56A">[SP-800-56A]</dt>
    <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span class="seriesInfo">NIST Special Publication 800-56A Revision 3</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.SP.800-56Ar3">https://doi.org/10.6028/NIST.SP.800-56Ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="CDDL">
<section id="appendix-A">
      <h2 id="name-cddl-definitions">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-cddl-definitions" class="section-name selfRef">CDDL Definitions</a>
      </h2>
<p id="appendix-A-1">This section compiles the CDDL definitions for easy reference, incorporating errata filed against <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div class="breakable lang-CDDL sourcecode" id="appendix-A-2">
<pre>
suites = [ 2* int ] / int

ead = (
  ead_label : int,
  ? ead_value : bstr,
)

EAD_1 = (1* ead)
EAD_2 = (1* ead)
EAD_3 = (1* ead)
EAD_4 = (1* ead)

message_1 = (
  METHOD : int,
  SUITES_I : suites,
  G_X : bstr,
  C_I : bstr / -24..23,
  ? EAD_1,
)

message_2 = (
  G_Y_CIPHERTEXT_2 : bstr,
)

PLAINTEXT_2B = (
  C_R : bstr / -24..23,
  ? EAD_2,
)

message_3 = (
  CIPHERTEXT_3 : bstr,
)

PLAINTEXT_3A = (
  ID_CRED_PSK : header_map / bstr / -24..23,
  CIPHERTEXT_3B : bstr,
)

PLAINTEXT_3B = (
  ? EAD_3
)

message_4 = (
  CIPHERTEXT_4 : bstr,
)

PLAINTEXT_4 = (
  ? EAD_4,
)

error = (
  ERR_CODE : int,
  ERR_INFO : any,
)

info = (
  info_label : int,
  context : bstr,
  length : uint,
)
</pre><a href="#appendix-A-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vectors">
<section id="appendix-B">
      <h2 id="name-test-vectors">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<div id="message1">
<section id="appendix-B.1">
        <h3 id="name-message_1">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-message_1" class="section-name selfRef">message_1</a>
        </h3>
<p id="appendix-B.1-1">Both endpoints are authenticated with Pre-Shared Keys (METHOD = 4)<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-2">
<pre>
METHOD (CBOR Data Item) (1 byte)
04
</pre><a href="#appendix-B.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-3">The initiator selects cipher suite 0. A single cipher suite is encoded as an int:<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-4">
<pre>
SUITES_I (CBOR Data Item) (1 byte)
00
</pre><a href="#appendix-B.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-5">The Initiator creates an ephemeral key pair for use with the EDHOC key exchange algorithm:<a href="#appendix-B.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-6">
<pre>
Initiator's ephemeral private key
X (Raw Value) (32 bytes)
09 97 2D FE F1 EA AB 92 6E C9 6E 80 05 FE D2 9F 70 FF BF 4E
36 1C 3A 06 1A 7A CD B5 17 0C 10 E5
</pre><a href="#appendix-B.1-6" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.1-7">
<pre>
Initiator's ephemeral public key
G_X (Raw Value) (32 bytes)
7E C6 81 02 94 06 02 AA B5 48 53 9B F4 2A 35 99 2D 95 72 49
EB 7F 18 88 40 6D 17 8A 04 C9 12 DB
</pre><a href="#appendix-B.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-8">The Initiator selects its connection identifier C_I to be the byte string 0xA, which is encoded as 0xA since it is represented by the 1-byte CBOR int 10:<a href="#appendix-B.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-9">
<pre>
Connection identifier chosen by the Initiator
C_I (CBOR Data Item) (1 byte)
0A
</pre><a href="#appendix-B.1-9" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-10">No external authorization data<a href="#appendix-B.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-11">
<pre>
EAD_1 (CBOR Sequence) (0 bytes)
</pre><a href="#appendix-B.1-11" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-12">The Initiator constructs message_1:<a href="#appendix-B.1-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-13">
<pre>
message_1 (CBOR Sequence) (37 bytes)
04 02 58 20 7E C6 81 02 94 06 02 AA B5 48 53 9B F4 2A 35 99
2D 95 72 49 EB 7F 18 88 40 6D 17 8A 04 C9 12 DB 0A
</pre><a href="#appendix-B.1-13" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="message2">
<section id="appendix-B.2">
        <h3 id="name-message_2">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-message_2" class="section-name selfRef">message_2</a>
        </h3>
<p id="appendix-B.2-1">The Responder supports the most preferred and selected cipher suite 0, so SUITES_I is acceptable.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">The Responder creates an ephemeral key pair for use with the EDHOC key exchange algorithm:<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-3">
<pre>
Responder's ephemeral private key
Y (Raw Value) (32 bytes)
1E 1C 8F 2D F1 AA 71 10 B3 9F 33 BA 5E A8 DC CF 31 41 1E B3
3D 4F 9A 09 4C F6 51 92 D3 35 A7 A3
</pre><a href="#appendix-B.2-3" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.2-4">
<pre>
Responder's ephemeral public key
G_Y (Raw Value) (32 bytes)
ED 15 6A 62 43 E0 AF EC 9E FB AA BC E8 42 9D 5A D5 E4 E1 C4
32 F7 6A 6E DE 8F 79 24 7B B9 7D 83
</pre><a href="#appendix-B.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-5">The Responder selects its connection identifier C_R to be the byte string 0x5, which is encoded as 0x5 since it is represented by the 1-byte CBOR int -10:<a href="#appendix-B.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-6">
<pre>
Connection identifier chosen by the Responder
C_R (CBOR Data Item) (1 byte)
05
</pre><a href="#appendix-B.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-7">The transcript hash TH_2 is calculated using the EDHOC hash algorithm:
TH_2 = H( G_Y, H(message_1) ), where H(message_1) is:<a href="#appendix-B.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-8">
<pre>
H(message_1) (CBOR Data Item) (32 bytes)
19 CC 2D 2A 95 7E DD 80 10 90 42 FD E6 CC 20 C2 4B 6A 34 BC
21 C6 D4 9F EA 89 5D 4C 75 92 34 0E
</pre><a href="#appendix-B.2-8" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.2-9">
<pre>
TH_2 (CBOR Data Item) (32 bytes)
5B 48 34 AE 63 0A 8A 0E D0 B0 C6 F3 66 42 60 4D 01 64 78 C4
BC 81 87 BB 76 4D D4 0F 2B EE 3D DE
</pre><a href="#appendix-B.2-9" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-10">PRK_2e is specified in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.
To compute it, the Elliptic Curve Diffie-Hellman (ECDH) shared secret G_XY is needed.
It is computed from G_X and Y or G_Y and X:<a href="#appendix-B.2-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-11">
<pre>
G_XY (Raw Value) (ECDH shared secret) (32 bytes)
2F 4A 79 9A 5A B0 C5 67 22 0C B6 72 08 E6 CF 8F 4C A5 FE 38
5D 1B 11 FD 9A 57 3D 41 60 F3 B0 B2
</pre><a href="#appendix-B.2-11" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-12">Then, PRK_2e is calculated as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span><a href="#appendix-B.2-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-13">
<pre>
PRK_2e (Raw Value) (32 bytes)
D0 39 D6 C3 CF 35 EC A0 CD F8 19 E3 25 79 C7 7E 1F 30 3E FC
C4 36 20 50 99 48 A9 FD 47 FB D9 29
</pre><a href="#appendix-B.2-13" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-14">Since the Responder authenticates using PSK, PRK_3e2m = PRK_2e.<a href="#appendix-B.2-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-15">
<pre>
PRK_3e2m (Raw Value) (32 bytes)
D0 39 D6 C3 CF 35 EC A0 CD F8 19 E3 25 79 C7 7E 1F 30 3E FC
C4 36 20 50 99 48 A9 FD 47 FB D9 29
</pre><a href="#appendix-B.2-15" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-16">No external authorization data:<a href="#appendix-B.2-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-17">
<pre>
EAD_2 (CBOR Sequence) (0 bytes)
</pre><a href="#appendix-B.2-17" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-18">The Responder constructs PLAINTEXT_2B:<a href="#appendix-B.2-18" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-19">
<pre>
PLAINTEXT_2B (CBOR Sequence) (1 byte)
05
</pre><a href="#appendix-B.2-19" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-20">The Responder computes KEYSTREAM_2 as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span><a href="#appendix-B.2-20" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-21">
<pre>
KEYSTREAM_2 (CBOR Sequence) (1 byte)
EC
</pre><a href="#appendix-B.2-21" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-22">The Responder calculates CIPHERTEXT_2B as XOR between PLAINTEXT_2B and KEYSTREAM_2:<a href="#appendix-B.2-22" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-23">
<pre>
CIPHERTEXT_2B (CBOR Sequence) (1 byte)
E9
</pre><a href="#appendix-B.2-23" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-24">The Responder constructs message_2 as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.3.1" class="relref">Section 5.3.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>:<a href="#appendix-B.2-24" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-25">
<pre>
message_2 (CBOR Sequence) (35 bytes)
58 21 ED 15 6A 62 43 E0 AF EC 9E FB AA BC E8 42 9D 5A D5 E4
E1 C4 32 F7 6A 6E DE 8F 79 24 7B B9 7D 83 E9
</pre><a href="#appendix-B.2-25" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="message3">
<section id="appendix-B.3">
        <h3 id="name-message_3">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-message_3" class="section-name selfRef">message_3</a>
        </h3>
<p id="appendix-B.3-1">The Initiator computes PRK_4e3m, as described in Section 4, using SALT_4e3m and CRED_PSK:<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-2">
<pre>
SALT_4e3m (Raw Value) (32 bytes)
A7 C6 8F ED 7C F9 BB BC A3 83 F0 2B A4 27 45 51 EE DD 07 4A
1C F3 DB ED 4A 41 1F 33 1B 3A AA 59
</pre><a href="#appendix-B.3-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.3-3">
<pre>
CRED_PSK (Raw Value) (38 bytes)
A2 02 68 6D 79 64 6F 74 62 6F 74 08 A1 01 A3 01 04 02 41 10
20 50 50 93 0F F4 62 A7 7A 35 40 CF 54 63 25 DE A2 14
</pre><a href="#appendix-B.3-3" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.3-4">
<pre>
PRK_4e3m (Raw Value) (32 bytes)
6B 99 69 23 A8 81 B6 6E C4 05 AD 03 53 94 1A FB 2C DA A5 E2
AC 65 1D A0 57 9A 08 C7 86 50 2A 66
</pre><a href="#appendix-B.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-5">The transcript hash TH_3 is calculated using the EDHOC hash algorithm:<a href="#appendix-B.3-5" class="pilcrow">¶</a></p>
<p id="appendix-B.3-6">TH_3 = H( TH_2, PLAINTEXT_2 )<a href="#appendix-B.3-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-7">
<pre>
TH_3 (CBOR Data Item) (32 bytes)
BC 3B C6 10 D7 25 16 CD 70 3E F7 4C 3A 98 20 17 E5 5D 70 D2
7F 57 01 E8 91 BD 35 11 9E B9 79 88
</pre><a href="#appendix-B.3-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-8">No external authorization data:<a href="#appendix-B.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-9">
<pre>
EAD_3 (CBOR Sequence) (0 bytes)
</pre><a href="#appendix-B.3-9" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-10">The Initiator constructs firstly PLAINTEXT_3B as defined in Section 5.3.1.:<a href="#appendix-B.3-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-11">
<pre>
PLAINTEXT_3B (CBOR Sequence) (0 bytes)
</pre><a href="#appendix-B.3-11" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-12">It then computes CIPHERTEXT_3B as defined in Section 5.3.2. It uses ID_CRED_PSK, CRED_PSK and TH_3 as external_aad:<a href="#appendix-B.3-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-13">
<pre>
ID_CRED_PSK (CBOR Sequence) (1 byte)
10
</pre><a href="#appendix-B.3-13" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.3-14">
<pre>
CRED_PSK (Raw Value) (38 bytes)
A2 02 68 6D 79 64 6F 74 62 6F 74 08 A1 01 A3 01 04 02 41 10
20 50 50 93 0F F4 62 A7 7A 35 40 CF 54 63 25 DE A2 14
</pre><a href="#appendix-B.3-14" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.3-15">
<pre>
TH_3 (CBOR Data Item) (32 bytes)
A5 0B 64 8C E2 A6 23 BF C9 72 15 B2 6C 7C EE BD C4 4F 6F 79
EF AA BE 27 E8 A0 2A 25 C0 C4 93 CC
</pre><a href="#appendix-B.3-15" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-16">The initiator computes K_3 and IV_3<a href="#appendix-B.3-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-17">
<pre>
K_3 (CBOR Sequence) (16 bytes)
D8 57 B9 46 46 34 25 35 3C 3C DE BD CB 90 CB 26
</pre><a href="#appendix-B.3-17" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.3-18">
<pre>
IV_3 (CBOR Sequence) (13 bytes)
A1 F6 BE AF 84 64 83 2A 8D 02 C8 5F 04
</pre><a href="#appendix-B.3-18" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-19">It then computes CIPHERTEXT_3B:<a href="#appendix-B.3-19" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-20">
<pre>
CIPHERTEXT_3B (CBOR Sequence) (9 bytes)
48 D0 A4 37 3C 49 C1 76 9B
</pre><a href="#appendix-B.3-20" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-21">The Initiator computes KEYSTREAM_3 as defined in Section 4:<a href="#appendix-B.3-21" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-22">
<pre>
KEYSTREAM_3 (CBOR Sequence) ()
D0 1B 7A AD 4C AB BD 14 89 50
</pre><a href="#appendix-B.3-22" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-23">It then calculates PLAINTEXT_3A as stated in Section 5.3.2.:<a href="#appendix-B.3-23" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-24">
<pre>
PLAINTEXT_3A (CBOR Sequence) (10 bytes)
10 48 D0 A4 37 3C 49 C1 76 9B
</pre><a href="#appendix-B.3-24" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-25">It then uses KEYSTREAM_3 to derive CIPHERTEXT_3A:<a href="#appendix-B.3-25" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-26">
<pre>
CIPHERTEXT_3A (CBOR Sequence) (10 bytes)
C2 47 AA 2F 94 B8 F9 41 21 C5
</pre><a href="#appendix-B.3-26" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-27">The Initiator computes message_3 as defined in Section 5.3.2.:<a href="#appendix-B.3-27" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-28">
<pre>
message_3 (CBOR Sequence) (11 bytes)
4A C2 47 AA 2F 94 B8 F9 41 21 C5
</pre><a href="#appendix-B.3-28" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3-29">The transcript hash TH_4 is calculated using the EDHOC hash algorithm:
TH_4 = H( TH_3, ID_CRED_PSK, ? EAD_3, CRED_PSK )<a href="#appendix-B.3-29" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3-30">
<pre>
TH_4 (CBOR Data Item) (32 bytes)
E5 67 45 39 75 66 CF F9 A6 93 DF 29 8D A4 F9 9E 1F 92 57 54
44 6B 5B 11 09 61 59 E5 C4 FC 0B FD
</pre><a href="#appendix-B.3-30" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="message4">
<section id="appendix-B.4">
        <h3 id="name-message_4">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-message_4" class="section-name selfRef">message_4</a>
        </h3>
<p id="appendix-B.4-1">No external authorization data:<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.4-2">
<pre>
EAD_4 (CBOR Sequence) (0 bytes)
</pre><a href="#appendix-B.4-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.4-3">The Responder constructs PLAINTEXT_4:<a href="#appendix-B.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.4-4">
<pre>
PLAINTEXT_4 (CBOR Sequence) (0 bytes)
</pre><a href="#appendix-B.4-4" class="pilcrow">¶</a>
</div>
<p id="appendix-B.4-5">The Responder computes K_4 and IV_4<a href="#appendix-B.4-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.4-6">
<pre>
K_4 (CBOR Sequence) (16 bytes)
BC 34 CE B4 E3 58 36 06 A0 81 6A 53 A5 0A E1 07
</pre><a href="#appendix-B.4-6" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="appendix-B.4-7">
<pre>
IV_4 (CBOR Sequence) (13 bytes)
12 2B 58 9D EB 77 81 A1 A5 9D D4 42 7C
</pre><a href="#appendix-B.4-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B.4-8">The Responder computes message_4:<a href="#appendix-B.4-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.4-9">
<pre>
message_4 (CBOR Sequence) (9 bytes)
48 69 C1 F1 2E 13 44 A3 93
</pre><a href="#appendix-B.4-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="change-log">
<section id="appendix-C">
      <h2 id="name-change-log">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-C-1">RFC Editor: Please remove this appendix.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">From -03 to -04<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1.2.1">
              <p id="appendix-C-2.1.2.1.1">Test Vectors<a href="#appendix-C-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-2.1.2.2">
              <p id="appendix-C-2.1.2.2.1">Editorial changes<a href="#appendix-C-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1">From -02 to -03<a href="#appendix-C-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.2.2.1">
              <p id="appendix-C-2.2.2.1.1">Updated abstract and Introduction<a href="#appendix-C-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-2.2.2.2">
              <p id="appendix-C-2.2.2.2.1">Changed message_3 to hide the identity length from passive attackers<a href="#appendix-C-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-2.2.2.3">
              <p id="appendix-C-2.2.2.3.1">CDDL Definitions<a href="#appendix-C-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-2.2.2.4">
              <p id="appendix-C-2.2.2.4.1">Security considerations of independence of Session Keys<a href="#appendix-C-2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-C-2.2.2.5">
              <p id="appendix-C-2.2.2.5.1">Editorial changes<a href="#appendix-C-2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1">From -01 to -02<a href="#appendix-C-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.3.2.1">
              <p id="appendix-C-2.3.2.1.1">Changes to message_3 formatting and processing<a href="#appendix-C-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1">From -00 to -01<a href="#appendix-C-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.4.2.1">
              <p id="appendix-C-2.4.2.1.1">Editorial changes and corrections<a href="#appendix-C-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-D">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-D-1">The authors want to thank
<span class="contact-name">Christian Amsüss</span>,
<span class="contact-name">Scott Fluhrer</span>,
<span class="contact-name">Charlie Jacomme</span>,
<span class="contact-name">Marco Tiloca</span>,
and
<span class="contact-name">Francisco Lopez-Gomez</span>
for reviewing and commenting on intermediate versions of the draft.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">This work has been partly funded by PID2023-148104OB-C43 funded by MICIU/AEI/10.13039/501100011033 (ONOFRE4), FEDER/UE EU HE CASTOR under Grant Agreement No 101167904 and EU CERTIFY under Grant Agreement No 101069471.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-E">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Elsa Lopez-Perez</span></div>
<div dir="auto" class="left"><span class="org">Inria</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:elsa.lopez-perez@inria.fr" class="email">elsa.lopez-perez@inria.fr</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Göran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rafael Marin-Lopez</span></div>
<div dir="auto" class="left"><span class="org">University of Murcia</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rafa@um.es" class="email">rafa@um.es</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
